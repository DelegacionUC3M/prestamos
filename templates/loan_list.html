<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Listar préstamos</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/list.css') }}">
</head>

<script>
 /* Busca en la tabla el campo seleccionado*/
 /* Para hacer la busqueda case sensitive, eliminar toUpperCase*/
function searchItem() {
  var input, filter, table, tr, td, i, select;
  input = document.getElementById("Buscador");
  filter = input.value.toUpperCase();
  table = document.getElementById("Lista_prestamos");
  tr = table.getElementsByTagName("tr");
  select = document.getElementById("Opciones");

     // Obtiene el valor del selector
 var option = select.options[select.selectedIndex].value;
     // Itera sobre los las filas y oculta los elementos que no cumples la búsqueda
     for (i = 0; i < tr.length; i++) {
         // Busca en la primera columna, en este caso nombre del objeto
    td = tr[i].getElementsByTagName("td")[option];
    if (td) {
      if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
}
</script>
<body>
    <a href="{{ url_for('index') }}">Página principal</a><br>

    <input type="text" id="Buscador" onkeyup="searchItem()" placeholder="Buscar prestamo">

    <select id="Opciones">
      <option value="0">Usuario</option>
      <option value="1">Objeto</option>
      <option value="2">Cantidad</option>
      <option value="3">Fecha</option>
      <option value="4">Devolución</option>
    </select>

    <table id="Lista_prestamos">
      <tr>
          <th>Usuario</th>
          <th>Objeto prestado</th>
          <th>Cantidad</th>
          <th>Fecha del préstamo</th>
          <th>Fecha devolución</th>
      </tr>
    {% for loan in loans %}
      {% for item in items %}
        {% if item.id == loan.item_id %}
      <tr>
          <td>{{ loan.user }}</td>
          <td>{{ item.name }}</td>
          <td>{{ loan.amount }}</td>
          <td>{{ loan.loan_date }}</td>
          <td>{{ loan.refund_date }}</td>
      </tr>
        {% endif %}
      {% endfor %}
    {% endfor %}
    </table>


</body>
</html>
